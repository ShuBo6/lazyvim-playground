# LazyVim 分屏操作最佳实践

本文档介绍 LazyVim 中分屏（窗口管理）的使用方法和最佳实践。

## 核心概念

在 Vim/Neovim 中：
- **Buffer（缓冲区）**：加载到内存中的文件
- **Window（窗口）**：显示 buffer 的视口（分屏就是创建多个窗口）
- **Tab（标签页）**：窗口的集合

分屏本质上是创建多个窗口来同时显示不同的内容。

## 1. 创建分屏

### 基本分屏命令

| 快捷键 | 命令 | 说明 |
|--------|------|------|
| `<Space>-` | `:sp` | 水平分屏（上下布局） |
| `<Space>\|` | `:vsp` | 垂直分屏（左右布局） |

### 分屏并打开文件

```vim
:sp filename      " 水平分屏并打开文件
:vsp filename     " 垂直分屏并打开文件
:new              " 水平分屏并创建新文件
:vnew             " 垂直分屏并创建新文件
```

### 使用 Telescope 分屏打开

在 Telescope 文件选择器中：
- `Ctrl+x` - 水平分屏打开选中文件
- `Ctrl+v` - 垂直分屏打开选中文件

## 2. 在分屏间切换

### 推荐方式（LazyVim 默认）

```
Ctrl+h    移动到左边窗口
Ctrl+j    移动到下边窗口
Ctrl+k    移动到上边窗口
Ctrl+l    移动到右边窗口
```

这组快捷键与 Vim 的 `hjkl` 移动逻辑一致，**强烈建议形成肌肉记忆**。

### 其他切换方式

| 快捷键 | 说明 |
|--------|------|
| `<Space>ww` | 切换到其他窗口（循环） |
| `Ctrl+w w` | 切换到下一个窗口 |
| `Ctrl+w p` | 切换到上一个窗口 |
| `Ctrl+w t` | 切换到最左上角的窗口 |
| `Ctrl+w b` | 切换到最右下角的窗口 |

### 窗口编号跳转

```vim
:1wincmd w    " 跳转到第1个窗口
:2wincmd w    " 跳转到第2个窗口
```

## 3. 调整分屏大小

### 使用方向键（LazyVim 默认）

```
Ctrl+Up       增加窗口高度
Ctrl+Down     减少窗口高度
Ctrl+Left     减少窗口宽度
Ctrl+Right    增加窗口宽度
```

### 精确调整

```vim
:resize +5           " 高度增加5行
:resize -5           " 高度减少5行
:vertical resize +10 " 宽度增加10列
:vertical resize -10 " 宽度减少10列
```

### 快速调整

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+w =` | 均分所有窗口 |
| `Ctrl+w _` | 最大化当前窗口高度 |
| `Ctrl+w \|` | 最大化当前窗口宽度 |
| `Ctrl+w +` | 增加高度 |
| `Ctrl+w -` | 减少高度 |
| `Ctrl+w >` | 增加宽度 |
| `Ctrl+w <` | 减少宽度 |

## 4. 关闭分屏

| 快捷键 | 命令 | 说明 |
|--------|------|------|
| `<Space>wd` | `:close` | 关闭当前窗口 |
| `:q` | - | 关闭当前窗口 |
| `:only` | - | 只保留当前窗口，关闭其他 |
| `Ctrl+w c` | - | 关闭当前窗口 |
| `Ctrl+w o` | - | 只保留当前窗口 |

## 5. 移动和交换窗口

### 移动窗口位置

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+w H` | 将当前窗口移到最左边 |
| `Ctrl+w J` | 将当前窗口移到最下边 |
| `Ctrl+w K` | 将当前窗口移到最上边 |
| `Ctrl+w L` | 将当前窗口移到最右边 |

### 旋转窗口

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+w r` | 顺时针旋转窗口 |
| `Ctrl+w R` | 逆时针旋转窗口 |
| `Ctrl+w x` | 交换当前窗口与下一个窗口 |

## 6. 实用工作流示例

### 场景1：代码 + 文件树

```
1. <Space>e     打开文件树（Neo-tree）
2. 选择文件，回车打开
3. Ctrl+h       跳回文件树
4. Ctrl+l       跳到代码窗口
```

**技巧**：文件树打开文件后会自动关闭，需要持续显示可以用 `<Space>E`。

### 场景2：代码 + 终端

```
方式1：分屏终端
1. <Space>-     水平分屏
2. :term        在新窗口打开终端
3. Ctrl+k       跳到代码（上）
4. Ctrl+j       跳到终端（下）

方式2：浮动终端（推荐）
1. Ctrl+/       打开浮动终端
2. Ctrl+/       关闭浮动终端
（不占用分屏空间，更整洁）
```

### 场景3：对比两个文件

```
1. nvim file1.go           打开第一个文件
2. :vsp file2.go           垂直分屏打开第二个文件
3. Ctrl+h / Ctrl+l         在两个文件间切换
4. :diffthis               在两个窗口都执行，开启 diff 模式
5. :diffoff                关闭 diff 模式
```

### 场景4：代码 + 测试文件

```
1. 打开 main.go
2. :vsp main_test.go       垂直分屏打开测试文件
3. Ctrl+h/l                在代码和测试间切换
4. <Space>wd               关闭不需要的窗口
```

### 场景5：多文件开发

```
1. :vsp                    垂直分屏
2. <Space>ff               在新窗口用 Telescope 找文件
3. 重复以上步骤添加更多窗口
4. Ctrl+w =                均分所有窗口
```

### 场景6：查看定义同时保留原位置

```
1. 光标在函数调用处
2. <Space>-                先水平分屏
3. gd                      在新窗口跳转到定义
4. Ctrl+k                  跳回原窗口继续编辑
```

## 7. 最佳实践建议

### 推荐的习惯

1. **窗口切换只用 `Ctrl+h/j/k/l`**
   - 与 hjkl 逻辑一致
   - 形成肌肉记忆后非常高效

2. **不要开太多分屏**
   - 2-3 个窗口足够
   - 更多文件用 buffer 切换：`<Space>bb`

3. **垂直分屏比水平分屏更常用**
   - 代码通常是纵向长
   - 左右对比更符合阅读习惯

4. **善用浮动终端**
   - `Ctrl+/` 比分屏终端更整洁
   - 不占用编辑空间

5. **利用 Telescope 分屏打开**
   - `Ctrl+v` 垂直分屏打开
   - `Ctrl+x` 水平分屏打开

### 不推荐的做法

1. ❌ 开超过 4 个分屏（太乱，效率下降）
2. ❌ 频繁调整窗口大小（用 `Ctrl+w =` 均分更省事）
3. ❌ 用鼠标切换窗口（用键盘更快）

## 8. 快捷键速查表

### 创建分屏

| 快捷键 | 说明 |
|--------|------|
| `<Space>-` | 水平分屏 |
| `<Space>\|` | 垂直分屏 |
| `:sp [file]` | 水平分屏（可选打开文件） |
| `:vsp [file]` | 垂直分屏（可选打开文件） |

### 切换分屏

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+h` | 左 |
| `Ctrl+j` | 下 |
| `Ctrl+k` | 上 |
| `Ctrl+l` | 右 |

### 调整大小

| 快捷键 | 说明 |
|--------|------|
| `Ctrl+方向键` | 调整大小 |
| `Ctrl+w =` | 均分 |
| `Ctrl+w _` | 最大化高度 |
| `Ctrl+w \|` | 最大化宽度 |

### 关闭分屏

| 快捷键 | 说明 |
|--------|------|
| `<Space>wd` | 关闭当前窗口 |
| `:q` | 关闭当前窗口 |
| `:only` | 只保留当前窗口 |

## 9. 与其他功能配合

### 与 Neo-tree 配合

```
<Space>e      打开文件树（会自动在左侧创建窗口）
q             在文件树中按 q 关闭
<Space>E      在当前文件位置打开文件树
```

### 与 Telescope 配合

```
<Space>ff     查找文件
  - Enter     在当前窗口打开
  - Ctrl+v    垂直分屏打开
  - Ctrl+x    水平分屏打开
  - Ctrl+t    新标签页打开
```

### 与 LSP 配合

```
gd            跳转到定义
gr            查找引用（Telescope 窗口）
<Space>ca     代码操作
K             悬浮文档（不创建分屏）
```

### 与 Git 配合

```
<Space>gg     打开 LazyGit（浮动窗口）
<Space>gd     Git diff（可能会分屏）
```

## 10. 进阶技巧

### 保存和恢复窗口布局

```vim
:mksession ~/session.vim    " 保存当前会话（包括窗口布局）
:source ~/session.vim       " 恢复会话
```

### 在所有窗口执行命令

```vim
:windo set number           " 在所有窗口启用行号
:windo diffthis             " 在所有窗口开启 diff
```

### 预览窗口

```vim
:pedit filename             " 在预览窗口打开文件
Ctrl+w z                    " 关闭预览窗口
```

---

## 总结

**日常最常用的操作：**

1. `<Space>|` 或 `:vsp` - 垂直分屏
2. `Ctrl+h/j/k/l` - 窗口间切换
3. `<Space>wd` 或 `:q` - 关闭窗口
4. `Ctrl+/` - 浮动终端

**记住这四个操作，就能覆盖 90% 的分屏使用场景！**
